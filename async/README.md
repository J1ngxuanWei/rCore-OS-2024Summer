# async   魏靖轩
异步操作系统的代码实现

存放各个版本的内核。

内核初始版本使用ArceOS宏内核。

### sync文件夹：将process和thread合并为task，统一调度和处理

### syncwz文件夹：将task的执行流抽出来，在内核中显式切换，且采用无栈协程方式

### async文件夹：实现无栈协程的异步运行时，目前只是最顶层的异步

但是可以将async函数中的函数调用改为async的，然后一步步向下传染异步，最终到底层的驱动层，实现yield特性。

比如到了net层，首先为对应的结构体实现`FUTURE`特征和`poll`函数，那么当tcp等待时，就调用`yield().await`，这样就实现了从顶层到底层的异步。

目前还没向下传染，但是这个事情很简单，唯一算难一点的就是底层结构体的`FUTURE`实现，传染本身是简单的。

### async2文件夹：async的进一步版本

通用操作系统内核的无栈协程是正确的设计，可以减少内存的使用，但是一个栈的存在使得抢占成为了不可能，面临如键盘输入的更高优先级协程的处理请求时，不能让出控制权处理这些任务。

本分支实现了一个内核栈池的设计，通过少量栈的复用实现高优先级协程的抢占执行，兼顾通用操作系统内核的线程优先级抢占和无栈协程的低内存占用。
